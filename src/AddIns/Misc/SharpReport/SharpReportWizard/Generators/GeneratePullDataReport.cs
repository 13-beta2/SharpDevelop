//------------------------------------------------------------------------------
// <autogenerated>
//     This code was generated by a tool.
//     Runtime Version: 1.1.4322.2032
//
//     Changes to this file may cause incorrect behavior and will be lost if 
//     the code is regenerated.
// </autogenerated>
//------------------------------------------------------------------------------
using System;

using ICSharpCode.Core;

using SharpReportCore;
	/// <summary>
	/// This class is used to AutoGenerate a (PullData) Report
	/// (Reports, that grap the Data by themselve)
	/// </summary>
	/// <remarks>
	/// 	created by - Forstmeier Peter
	/// 	created on - 07.09.2005 13:23:14
	/// </remarks>
using System.Windows.Forms;

namespace ReportGenerator {	
	public class GeneratePullDataReport : AbstractReportGenerator {
		
		public GeneratePullDataReport(Properties customizer,
		                              ReportModel reportModel):base(customizer,reportModel){

			if (base.ReportModel.ReportSettings.DataModel != GlobalEnums.enmPushPullModel.PullData) {
				throw new ArgumentException ("Wrong DataModel in GeneratePullDataReport");
			}
		}
		
		#region ReportGenerator.IReportGenerator interface implementation
		public override void GenerateReport() {
			try {
				base.ReportModel.ReportSettings.ReportType = GlobalEnums.enmReportType.DataReport;
				base.ReportModel.ReportSettings.DataModel = GlobalEnums.enmPushPullModel.PullData;
				
				ReportItemCollection col = (ReportItemCollection)base.Customizer.Get ("ReportItemCollection");
				ColumnCollection columnCollection = (ColumnCollection)base.Customizer.Get ("ColumnCollection");
				this.ReportModel.ReportSettings.AvailableFieldsCollection = columnCollection;
					
				base.GenerateReport();	
				base.Manager.HeaderColumnsFromReportItems (base.ReportModel.PageHeader,col);
				base.Manager.DataColumnsFromReportItems (base.ReportModel.DetailSection,col);

				using (TableLayout layout = new TableLayout(base.ReportModel)){
					layout.BuildLayout();
				}
				
				base.AdjustAll();
			} catch (Exception) {
				throw;
			}
		
		}
		
		#endregion
	}
}
