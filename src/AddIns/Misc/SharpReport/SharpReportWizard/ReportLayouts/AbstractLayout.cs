//------------------------------------------------------------------------------
// <autogenerated>
//     This code was generated by a tool.
//     Runtime Version: 1.1.4322.2032
//
//     Changes to this file may cause incorrect behavior and will be lost if 
//     the code is regenerated.
// </autogenerated>
//------------------------------------------------------------------------------
using System;
using System.Drawing;
using System.Drawing.Printing;

using SharpReportCore;

	/// <summary>
	/// This class is the BaseClass for all Layout's
	/// </summary>
	
namespace ReportGenerator {	
	public class AbstractLayout : IReportLayout,IDisposable {
		ReportModel reportModel;
		/// <summary>
		/// Default constructor - initializes all fields to default values
		/// </summary>
		public AbstractLayout() {
		}
		public AbstractLayout(ReportModel reportModel){
			this.reportModel = reportModel;
		}
		
		protected  void FormatSingleEntry (IItemRenderer item,
		                                  int itemWidth,
		                                  Point location,
		                                  Font font) {
			if (item == null) {
				throw new ArgumentNullException("item");
			}
			item.Size = new Size (itemWidth,item.Size.Height + GlobalValues.EnlargeControl);
			item.Location = new Point (location.X,location.Y);
			item.Font =  font;
		}
		
		#region ReportGenerator.IReportLayout interface implementation
		public virtual void BuildLayout() {
			throw new NotImplementedException("AbstractLayout:BuildLayout must be overriden");
		}
		
		public virtual void BuildLayout(ReportModel reportModel) {
			throw new NotImplementedException("AbstractLayout:BuildLayout must be overriden");
		}
		#endregion
		
		#region Properties
		
		public ReportModel ReportModel {
			get {
				return reportModel;
			}
		}
		
		public ReportSettings ReportSettings {
			get {
				return reportModel.ReportSettings;
			}
		}
		
		public PageSettings PageSettings {
			get {
				return reportModel.ReportSettings.PageSettings;
			}
		}
		
		public int UseablePageWidth {
			get {
				return this.PageSettings.Bounds.Width - this.ReportSettings.DefaultMargins.Left - this.ReportSettings.DefaultMargins.Right;
			}
		}
		#endregion
		
		
		#region System.IDisposable interface implementation
		public void Dispose() {
			
		}
		#endregion
		
	}
}
