//------------------------------------------------------------------------------
// <autogenerated>
//     This code was generated by a tool.
//     Runtime Version: 1.1.4322.2032
//
//     Changes to this file may cause incorrect behavior and will be lost if 
//     the code is regenerated.
// </autogenerated>
//------------------------------------------------------------------------------


using System;
using System.Data;
using System.Windows.Forms;
using SharpQuery.Gui.DataView;
	
using SharpReportCore;

	
/// <summary>
/// This Form, derived from SharpQuery.SqlParameterInput handles the Input of
/// Parameter's needed for Query's
/// </summary>
/// <remarks>
/// 	created by - Forstmeier Peter
/// 	created on - 25.06.2005 17:22:13
/// </remarks>
namespace SharpReportAddin {	
	public class ParameterInput : SQLParameterInput {
		
		
		private AbstractParametersCollection parametersCollection;
		private string reportName;
		
		
		public ParameterInput(string reportName,
		                      AbstractParametersCollection parametersCollection ){
			this.parametersCollection = parametersCollection;
			this.reportName = reportName;
			
			base.dataGrid.CaptionVisible = true;
			base.dataGrid.CaptionText = reportName;
			FillParameters();                 
		}
		
		void FillParameters() {
			SqlParameter par = null;
			for (int i = 0; i < this.parametersCollection.Count; i ++) {
				par = (SqlParameter)this.parametersCollection[i];
				if (par.ParameterDirection == ParameterDirection.ReturnValue) {
					i--;
					this.parametersCollection.Remove( par );
				}
			}
			base.dataGrid.DataSource = this.parametersCollection;
			base.dataGrid.DataMember = null;
		}
	}
}
